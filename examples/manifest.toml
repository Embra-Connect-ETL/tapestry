# Whether the placeholder in queries should use `posargs` (positional
# arguments) or `variables` syntax
placeholder = "posargs"

# Where the rendered sql files will be created. The paths must be
# relative to this manifest file.
[output_dir]
queries = "output/sql"
tests = "output/tests"

[[templates]]
path = "sql/songs.sql.j2"
all_conds = [ "artist", "file_format", "album_name" ]

[[templates]]
path = "sql/artists_long_songs.sql.j2"
all_conds = [ "genre", "limit" ]

[[queries]]
id = "songs@artist+album"
template = "sql/songs.sql.j2"
conds = [ "artist", "album_name" ]
output = "songs__artist__album.sql"

[[queries]]
id = "songs@artist&file_format+album"
template = "sql/songs.sql.j2"
conds = [ "artist", "album_name", "file_format" ]
# check if it's viable to compute the output filename based on the
# id. E.g. by separating different groups (@, +) by double underscore
# and items in each group by hyphen
output = "songs__artist-file_format__album.sql"

[[queries]]
id = "artists_long_songs"
template = "sql/artists_long_songs.sql.j2"
conds = []
output = "all_artists_long_songs.sql"

[[queries]]
id = "artists_long_songs@genre*limit"
template = "sql/artists_long_songs.sql.j2"
conds = [ "genre", "limit" ]
output = "top_artists_long_songs_of_genre.sql"

[[tests]]
query = "songs@artist&file_format+album"
# Following variables will be available inside the template
#
#  1. prepared_statement
#
# (only 1 for now)
template = "sql/songs_test.sql.j2"
output = "test_<queryname><n>.sql"

[[tests]]
query = "artists_long_songs@genre*limit"
template = "sql/artists_long_songs_test.sql.j2"
output = "artists_long_songs-genre-limit_test01.sql"

